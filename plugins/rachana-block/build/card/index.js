(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.blockEditor,l=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}).replace(/ /g,"/"),o=Math.random().toString(36).substr(2,9),n=e=>e.includes("card-horizontal"),r=e=>moment(e).fromNow(),c=({color:e="white"})=>(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{d:"M10.475 11.525L11.525 10.475L8.75 7.7V4.25H7.25V8.3L10.475 11.525ZM8 15.5C6.9625 15.5 5.9875 15.3031 5.075 14.9094C4.1625 14.5156 3.36875 13.9813 2.69375 13.3063C2.01875 12.6313 1.48438 11.8375 1.09063 10.925C0.696875 10.0125 0.5 9.0375 0.5 8C0.5 6.9625 0.696875 5.9875 1.09063 5.075C1.48438 4.1625 2.01875 3.36875 2.69375 2.69375C3.36875 2.01875 4.1625 1.48438 5.075 1.09063C5.9875 0.696875 6.9625 0.5 8 0.5C9.0375 0.5 10.0125 0.696875 10.925 1.09063C11.8375 1.48438 12.6313 2.01875 13.3063 2.69375C13.9813 3.36875 14.5156 4.1625 14.9094 5.075C15.3031 5.9875 15.5 6.9625 15.5 8C15.5 9.0375 15.3031 10.0125 14.9094 10.925C14.5156 11.8375 13.9813 12.6313 13.3063 13.3063C12.6313 13.9813 11.8375 14.5156 10.925 14.9094C10.0125 15.3031 9.0375 15.5 8 15.5ZM8 14C9.6625 14 11.0781 13.4156 12.2469 12.2469C13.4156 11.0781 14 9.6625 14 8C14 6.3375 13.4156 4.92188 12.2469 3.75313C11.0781 2.58438 9.6625 2 8 2C6.3375 2 4.92188 2.58438 3.75313 3.75313C2.58438 4.92188 2 6.3375 2 8C2 9.6625 2.58438 11.0781 3.75313 12.2469C4.92188 13.4156 6.3375 14 8 14Z",fill:e})),s=({color:e="white"})=>(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{d:"M9 9C8.175 9 7.46875 8.70625 6.88125 8.11875C6.29375 7.53125 6 6.825 6 6C6 5.175 6.29375 4.46875 6.88125 3.88125C7.46875 3.29375 8.175 3 9 3C9.825 3 10.5313 3.29375 11.1188 3.88125C11.7063 4.46875 12 5.175 12 6C12 6.825 11.7063 7.53125 11.1188 8.11875C10.5313 8.70625 9.825 9 9 9ZM3 15V12.9C3 12.475 3.10938 12.0844 3.32812 11.7281C3.54688 11.3719 3.8375 11.1 4.2 10.9125C4.975 10.525 5.7625 10.2344 6.5625 10.0406C7.3625 9.84688 8.175 9.75 9 9.75C9.825 9.75 10.6375 9.84688 11.4375 10.0406C12.2375 10.2344 13.025 10.525 13.8 10.9125C14.1625 11.1 14.4531 11.3719 14.6719 11.7281C14.8906 12.0844 15 12.475 15 12.9V15H3ZM4.5 13.5H13.5V12.9C13.5 12.7625 13.4656 12.6375 13.3969 12.525C13.3281 12.4125 13.2375 12.325 13.125 12.2625C12.45 11.925 11.7688 11.6719 11.0813 11.5031C10.3938 11.3344 9.7 11.25 9 11.25C8.3 11.25 7.60625 11.3344 6.91875 11.5031C6.23125 11.6719 5.55 11.925 4.875 12.2625C4.7625 12.325 4.67188 12.4125 4.60313 12.525C4.53438 12.6375 4.5 12.7625 4.5 12.9V13.5ZM9 7.5C9.4125 7.5 9.76563 7.35313 10.0594 7.05938C10.3531 6.76563 10.5 6.4125 10.5 6C10.5 5.5875 10.3531 5.23438 10.0594 4.94063C9.76563 4.64688 9.4125 4.5 9 4.5C8.5875 4.5 8.23438 4.64688 7.94063 4.94063C7.64688 5.23438 7.5 5.5875 7.5 6C7.5 6.4125 7.64688 6.76563 7.94063 7.05938C8.23438 7.35313 8.5875 7.5 9 7.5Z",fill:e})),i=JSON.parse('{"title":"","content":"","imageUrl":"","contentColor":"var(--cgds-text-color)","titleColor":"var(--cgds-primary)","href":"","linkText":"Read More","lastUpdated":"","id":"","post":[],"fetchPosts":false,"bgColor":"#ffffff","sizeAuto":false,"showImage":false,"showRouteButton":false,"style":"","inputOption":"","displayContent":false,"posts":[],"btnColor":"var(--cgds-100)","imageWidth":35,"imageAspectRatio":"ratio-4x3","border":true,"padding":true,"newTab":true,"author":"","showAuthorAndTime":false}'),m=window.wp.blocks,d=window.wp.element,g=window.wp.components,C=({label:e,color:a,defaultColor:l,onChange:o})=>{const[n,r]=(0,d.useState)(a);return(0,t.createElement)("div",{className:"components-base-control"},(0,t.createElement)("label",{className:"components-base-control__label"},e),(0,t.createElement)("div",{style:{display:"flex",alignItems:"center"}},(0,t.createElement)("input",{type:"text",value:n,onChange:e=>{const t=e.target.value;r(t),o(t)},className:"components-text-control__input",style:{marginRight:"10px",flex:"1"}}),(0,t.createElement)("input",{type:"color",value:n.startsWith("var(")?"#000000":n,onChange:e=>{const t=e.target.value;r(t),o(t)},className:"components-color-picker__input",style:{flex:"0"}}),(0,t.createElement)("button",{className:"components-button components-core-button",onClick:()=>{r(l),o(l)},style:{marginLeft:"10px"}},"Reset")))},u=window.wp.apiFetch;var h=e.n(u);const p=async(e,t,a,l)=>{const o=[...new Set(e.map((e=>e[a])))],n=await Promise.all(o.map((async e=>{const a=await h()({path:`/wp/v2/${t}/${e}`});return{[e]:l(a)}})));return Object.assign({},...n)};(0,m.registerBlockType)("rachana-block/card",{attributes:(e=>{const t={id:o};for(const a in e)t[a]={type:typeof e[a],default:e[a]};return t})(i),edit:({attributes:e,setAttributes:o})=>{const{newTab:c,border:s,padding:m,btnColor:u,inputOption:b,style:E,post:w,posts:v,contentColor:f,titleColor:y,bgColor:k,date:x,author:N,showAuthorAndTime:T,showImage:S,imageUrl:I,imageWidth:R,title:A,content:B,showRouteButton:_,linkText:M,href:L,displayContent:O,imageAspectRatio:P,sizeAuto:$}=e,[U,z]=(0,d.useState)([]),[D,F]=(0,d.useState)(null),H=(0,a.useBlockProps)();return(0,d.useEffect)((()=>{(async()=>{const e=await(async(e=null)=>{const t=(await h()({path:"/wp/v2/categories"})).map((({name:e,id:t,link:a})=>({label:e,value:t,link:a})));return e&&e({categories:t}),t})();z(e)})().then(null)}),[]),(0,d.useEffect)((()=>{"fetch"===b&&D&&(async(e,t=null)=>{try{let a;a=e?await h()({path:`/wp/v2/posts?order=desc&orderby=date&per_page=10&categories=${e}`}):await h()({path:"/wp/v2/posts"});const l=a.map((e=>({label:e.title.rendered,value:e.id})));if(!t)return l;t({posts:l})}catch(e){console.error("Error fetching posts:",e)}})(D,o).then(null)}),[b,D]),(0,t.createElement)("div",{...H},(0,t.createElement)(a.InspectorControls,null,(0,t.createElement)(g.PanelBody,{title:"Card Settings"},(0,t.createElement)(g.SelectControl,{label:"Input Option",value:b,options:[{label:"Manual Input",value:"manual"},{label:"Fetch Post",value:"fetch"}],onChange:e=>o({inputOption:e})}),"fetch"===b&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(g.SelectControl,{label:"Category",value:D,options:[{label:"Select a category",value:null},...U],onChange:e=>{const{intCategoryId:t}=((e,t)=>{const a=parseInt(e,10),l=t.find((e=>e.value===a));return{link:l.link,label:l.label,intCategoryId:a}})(e,U);F(t)}}),D&&(0,t.createElement)(g.ComboboxControl,{label:"Select a Post",value:w?.id,options:v,onChange:e=>(async(e,t=null)=>{const a=`/wp/v2/posts/${e}`;try{const e=await h()({path:a}),o=await p([e],"users","author",(e=>`${e.name} (${e.slug})`)),n=await p([e],"categories","categories",(e=>e)),{cleanContent:r,imageLink:c}=(e=>{const t=document.createElement("div");return t.innerHTML=e,{cleanContent:t.textContent||t.innerText||"",imageLink:t.querySelector("img")?t.querySelector("img").src:null}})(e.content.rendered),s={content:r,imageLink:c,date:l(e.date),href:e.link,title:e.title.rendered,author:o[e.author],categories:e.categories.map((e=>n[e]))};if(!t)return s;t({title:s.title,imageUrl:s.imageLink,lastUpdated:s.date,href:s.href,content:s.content,author:s.author,categories:s.categories,date:l(s.date)})}catch(e){return null}})(e,o)})),(0,t.createElement)(g.SelectControl,{label:"Card Style",value:E||"",options:[{label:"Vertical",value:""},{label:"Horizontal",value:"card-horizontal"}],onChange:e=>o({style:e})}),S&&n(E)&&(0,t.createElement)(g.SelectControl,{label:"Image Width",value:R,options:[{label:"20%",value:20},{label:"35%",value:35},{label:"50%",value:50}],onChange:e=>o({imageWidth:e})}),(0,t.createElement)(g.SelectControl,{label:"Image Aspect Ratio",value:P,options:[{label:"21x9",value:"ratio-21x9"},{label:"16x9",value:"ratio-16x9"},{label:"4x3",value:"ratio-4x3"},{label:"1x1",value:"ratio-1x1"}],onChange:e=>o({imageAspectRatio:e})}),(0,t.createElement)(C,{label:"Body Text Color",color:f,defaultColor:i.contentColor,onChange:e=>o({contentColor:e})}),(0,t.createElement)(C,{label:"Card Title Color",color:y,defaultColor:i.titleColor,onChange:e=>o({titleColor:e})}),(0,t.createElement)(C,{label:"Card Background Color",color:k,defaultColor:i.bgColor,onChange:e=>o({bgColor:e})}),(0,t.createElement)(C,{label:"Card Button Color",color:u,defaultColor:i.btnColor,onChange:e=>o({btnColor:e})}),(0,t.createElement)(g.Button,{isSecondary:!0,onClick:()=>{o({contentColor:i.contentColor,titleColor:i.titleColor,bgColor:i.bgColor})}},"Reset Colors to Default"))),(0,t.createElement)("div",{className:"card",style:{background:k}},(0,t.createElement)(g.ToggleControl,{label:"Display Border: "+(s?"On":"Off"),checked:s,onChange:e=>o({border:e})}),(0,t.createElement)(g.ToggleControl,{label:"Size Auto",checked:$,onChange:e=>o({sizeAuto:e})}),(0,t.createElement)(g.ToggleControl,{label:"Padding",checked:m,onChange:e=>o({padding:e})}),(0,t.createElement)(g.ToggleControl,{label:"Show Author and Time",checked:T,onChange:e=>o({showAuthorAndTime:e})}),T&&(0,t.createElement)("div",{className:"components-base-control"},(0,t.createElement)(g.DatePicker,{currentDate:x,onChange:e=>o({date:l(e)}),isClearable:!0}),(0,t.createElement)(a.RichText,{tagName:"p",value:r(x),onChange:e=>o({date:r(e)}),placeholder:"Last updated: [date/time]...",className:"card-text"}),(0,t.createElement)(a.RichText,{tagName:"p",value:N,onChange:e=>o({author:e}),className:"card-text",placeholder:"Author name goes here"})),(0,t.createElement)(g.ToggleControl,{label:"Show Image",checked:S,onChange:e=>o({showImage:e})}),S&&(0,t.createElement)("div",{className:"col-md-12 image-upload-placeholder"},(0,t.createElement)(a.MediaUpload,{onSelect:e=>o({imageUrl:e.url}),allowedTypes:["image"],value:I,render:({open:e})=>(0,t.createElement)("div",null,I?(0,t.createElement)("div",{className:"uploaded-image"},(0,t.createElement)("img",{src:I,alt:"Card Image"}),(0,t.createElement)(g.Button,{onClick:()=>o({imageUrl:null}),isLink:!0,isDestructive:!0},"Remove Image")):(0,t.createElement)(g.Button,{onClick:e,isPrimary:!0},"Upload Image"))})),(0,t.createElement)(a.RichText,{tagName:"h2",value:A,onChange:e=>o({title:e}),placeholder:"Enter card title...",className:"card-title",allowedFormats:["core/bold","core/heading"]}),(0,t.createElement)(g.ToggleControl,{label:"Display Content",checked:O,onChange:e=>o({displayContent:e})}),O&&(0,t.createElement)(a.RichText,{tagName:"p",value:B,onChange:e=>o({content:e}),placeholder:"Enter card content...",className:"card-content",allowedFormats:["core/bold","core/heading"]}),(0,t.createElement)(g.ToggleControl,{label:"Show Route Button",checked:_,onChange:e=>o({showRouteButton:e})}),_&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.RichText,{tagName:"p",value:M,onChange:e=>o({linkText:e}),placeholder:'Enter link guide e.g., "Click here for more details" ...',className:"card-content",allowedFormats:["core/bold","core/heading"]}),(0,t.createElement)(a.RichText,{tagName:"p",value:L,onChange:e=>o({href:e}),placeholder:"Enter the link to the page ...",className:"card-content",allowedFormats:["core/bold","core/heading"]}),(0,t.createElement)(g.ToggleControl,{label:"Open In New Tab?",checked:c,onChange:e=>o({newTab:e})}))))},save:({attributes:e})=>{const{date:l,newTab:o,border:i,padding:m,btnColor:d,style:g,contentColor:C,titleColor:u,bgColor:h,showAuthorAndTime:p,showImage:b,sizeAuto:E,imageUrl:w,imageWidth:v,title:f,content:y,showRouteButton:k,linkText:x,href:N,displayContent:T,author:S,imageAspectRatio:I}=e,R=a.useBlockProps.save({className:E?"size-auto":""});return(0,t.createElement)("div",{...R},(0,t.createElement)("div",{className:`padding-${m}`},(0,t.createElement)("div",{className:`cgds card base ${g} border-${i}`},b&&w&&(0,t.createElement)("div",{className:`img-container ratio ${I||""}`,style:n(g)&&{flex:`0 1 ${v}%`}},(0,t.createElement)("img",{className:n(g)?"card-img-left":"card-img-top",src:w,alt:"Card Image"})),(0,t.createElement)("div",{className:"card-body",style:{background:h,...n(g)&&{flex:`0 1 ${100-v}%`}}},p&&(0,t.createElement)("div",{className:"author-time"},(0,t.createElement)(c,{color:"var(--cgds-gray-500)"}),(0,t.createElement)("time",{className:"text-muted"}," ",r(l)," "),(0,t.createElement)(s,{color:"var(--cgds-gray-500)"}),(0,t.createElement)("small",{className:"text-muted card-text-muted"}," ",S)),(0,t.createElement)("div",{className:"content"},(0,t.createElement)("p",{className:"stretched-link card-title",style:{color:u},dangerouslySetInnerHTML:{__html:f}}),T&&(0,t.createElement)("p",{className:"card-text mt-0",style:{color:C},dangerouslySetInnerHTML:{__html:y}})),x&&k&&(0,t.createElement)("div",{className:"route-icon"},(0,t.createElement)("a",{className:"card-link",href:N,style:{color:d},target:o?"_blank":"_self",rel:o?"noopener noreferrer":""},(0,t.createElement)("i",{className:"bi bi-arrow-right-circle-fill"}),(0,t.createElement)("span",{dangerouslySetInnerHTML:{__html:x}})))))))}})})();